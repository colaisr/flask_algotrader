{% extends 'layouts/base.html' %}
{% block page_title %}
Stock Score | Stock Info
{% endblock %}

{% block styles %}
{% endblock %}

{% block content %}
<!--title row-->
<div class="row mb-3">
    <div class="col">
        <div class="card bg-100 shadow-none border">
            <div class="row gx-0 p-2 flex-between-center">
                <div class="col-md-auto align-items-center m-1">
                    <div class="d-flex mb-1 align-items-center justify-content-between">
                        <div class="d-flex mb-1 align-items-center page-title-heading modal-cursor">
                            <img class="img-fluid" src="{{candidate.logo}}" width="50">
                            <div class="ps-2">
                                <h5 class="fw-bold mb-0">
                                    {{candidate.ticker}}
                                </h5>
                                <p class="fs--1 mb-0 text-500">{{candidate.company_name}}</p>
                            </div>
                        </div>
                        {% if not in_list %}
                        <div class="me-2 badge bg-info rounded-pill d-md-none add-candidate">
                            <span><i class="fas fa-plus me-1"></i>Follow</span>
                        </div>
                        {% else %}
                        <div class="me-2 badge bg-success rounded-pill d-md-none candidate-in-list">
                            <span><i class="fas fa-check"></i>Remove from list</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="me-2 badge bg-{{bg_upd_color}} rounded-pill d-none d-md-inline">Last Update(UTC) :
                        {{last_update}}
                    </div>
                    <div class="d-none d-md-block ps-1 pt-1"><a class="ticker-web menu__link article-link" target="_blank" href="{{candidate.website}}">Go to website</a></div>
                </div>
                <div class="col-md-auto page-fmp-data d-sm-none d-lg-inline m-1">
                    <div class="fs--1">
                        <div class="fmp-price-content fw-bold">
                            Price: <span class="fmp-price text-primary float-end"></span>
                        </div>
                        <div class="fmp-change-content">
                            Change: <span class="fmp-change float-end ps-4 fs--2"></span>
                        </div>
                        <div class="fmp-close-content">
                            Last Close: <span class="fmp-last-close float-end fs--2"></span>
                        </div>
                        <div class="help-cursor fmp-pne-content">
                            P/E
                            <i class="fas fa-info-circle info-icon pl-1 pr-1 jb-tooltip-info jb-info-4 text-400" data-tooltip-id="4"></i>
                            <span class="fmp-pe fw-bold float-end fs--2"></span>
                        </div>
                        <div class="help-cursor fmp-eps-content">
                            EPS <i class="fas fa-info-circle info-icon pl-1 pr-1 jb-tooltip-info jb-info-3 text-400" data-tooltip-id="3"></i> <span class="fmp-eps float-end fs--2"></span>
                        </div>
                    </div>
                </div>
                <div class="col-md-auto d-flex m-1 me-2">
                    <div class="bage-score bg-{{score_bg}} ms-2 rounded-3">
                        <span class="badge rounded-pill bg-light text-dark m-2 mt-4 fs-1">{{market_data.algotrader_rank}}</span>
                        <div class="score-title text-light text-center fs-1 fw-bold">Score</div>
                    </div>
                    <div class="market-data-actions px-2 flex-fill d-flex flex-column justify-content-between">
                        <div title="Volatility of a stock in relation to the overall market. 12M" class="justify-content-between align-items-center help-cursor ticker-data mr-2 badge {% if market_data.beta is not none and user_settings.algo_min_beta is not none and market_data.beta >= user_settings.algo_min_beta %}
                            btn-success
                            {% else %}
                            btn-warning
                            {% endif %}">
                            <span class="float-start">
                                Beta
                            </span>
                            <span class="badge rounded-pill bg-light text-dark px-3 float-end">
                                {% if market_data.beta is not none%}
                                {{market_data.beta | round(1)}}
                                {% else %}
                                0
                                {% endif %}
                            </span>
                        </div>
                        <div title="Lower than cheapest analyst prediction" class="justify-content-between align-items-center help-cursor ticker-data mr-2 badge {% if market_data.under_priced_pnt is not none and user_settings.algo_min_underprice is not none and market_data.under_priced_pnt >= user_settings.algo_min_underprice %}
                            btn-success
                            {% else %}
                            btn-warning
                            {% endif %}">
                            <span class="float-start">
                                Underpriced
                            </span>
                            <span class="badge rounded-pill bg-light text-dark px-3 float-end">
                                {% if market_data.under_priced_pnt is not none%}
                                {{market_data.under_priced_pnt | round(1)}}
                                {% else %}
                                0
                                {% endif %}
                            </span>
                        </div>
                        <div title="Todays good entry point. Based on 1 last year intraday volatility" class="justify-content-between align-items-center help-cursor ticker-data mr-2 badge btn-success">
                            <span class="float-start me-2">
                                Buying trigger
                            </span>
                            <span class="badge rounded-pill bg-light text-dark px-3 float-end">
                                {{market_data.buying_target_price_fmp | round(1)}}
                            </span>
                        </div>
                    </div>
                </div>
                <div class="col-md-auto m-1 d-none d-md-inline">
                    <div class="fs--1">
                        <div class="ticker-exchange ticket-info-row d-flex flex-between-center">
                            <div class="ticket-info-title">Exchange:</div>
                            <div class="ticker-sector-val ticket-info-val" data-exchange="{{candidate.exchange_short}}">{{candidate.exchange_short}}</div>
                        </div>
                        <div class="ticker-sector ticket-info-row d-flex flex-between-center">
                            <div class="ticket-info-title">Sector:</div>
                            <div class="ticker-sector-val ticket-info-val" data-sector="{{candidate.sector}}">{{candidate.sector}}</div>
                        </div>
                        <div class="ticker-industry ticket-info-row d-flex flex-between-center">
                            <div class="ticket-info-title pe-5">Industry:</div>
                            <div class="ticket-info-val ps-5">{{candidate.industry}}</div>
                        </div>
                        <div class="ticker-action ticket-info-row d-flex flex-between-center">
                            <div class="ticket-info-title">Personal List:</div>
                            <div class="ticket-info-val div-content">
                                {% if not in_list %}
                                <button type="button" class="btn btn-outline-info add-candidate btn-sm fs--2">Follow</button>
                                {% else %}
                                <button type="button" class="btn btn-sm btn-outline-success candidate-in-list fs--2">
                                    <i class="fas fa-check"></i>Remove from list
                                </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col">
        <div class="card mb-1">
            <div id="container" style="width:100%; height:380px;"></div>
        </div>
    </div>
</div>
<div class="echart-line-chart-example" style="min-height: 300px;" data-echart-responsive="true"></div>

<div class="row ticket-info-tabs">
    <div class="col">
        <div class="card mb-1">
            <ul class="nav nav-tabs" id="ticker-info-tubs" role="tablist">
              <li class="nav-item"><a class="nav-link active" id="fundamentals-tab" data-bs-toggle="tab" href="#tab-fundamentals" role="tab" aria-controls="tab-fundamentals" aria-selected="true">Fundamentals</a></li>
              <li class="nav-item"><a class="nav-link" id="news-tab" data-bs-toggle="tab" href="#tab-news" role="tab" aria-controls="tab-news" aria-selected="false">News</a></li>
              <li class="nav-item"><a class="nav-link" id="insiders-tab" data-bs-toggle="tab" href="#tab-insiders" role="tab" aria-controls="tab-insiders" aria-selected="false">Insiders</a></li>
              <li class="nav-item"><a class="nav-link" id="press-relises-tab" data-bs-toggle="tab" href="#tab-press-relises" role="tab" aria-controls="tab-press-relises" aria-selected="false">Press Relises</a></li>
              <li class="nav-item"><a class="nav-link" id="technicals-tab" data-bs-toggle="tab" href="#tab-technicals" role="tab" aria-controls="tab-technicals" aria-selected="false">Technical</a></li>

            </ul>
            <div class="tab-content border-x border-bottom p-3" id="ticker-info-tubs-content">
                <div class="tab-pane fade show active" id="tab-fundamentals" role="tabpanel" aria-labelledby="fundamentals-tab">
                  <div class="main-card mb-3 card">
                    <div class="card-body tab-fundamentals-summary-card" style="position: relative;">
                        <div class="card-header">
                            Fundamentals (12 Month)
                        </div>
                        <div class="div-content fundamentals-summary row pt-2"></div>
                        {% include 'layouts/loader.html' %}
                    </div>
                </div>
                <div class="main-card mb-3 card">
                    <div class="card-body tab-fundamentals-feed-card row" style="position: relative;"></div>
                </div>
                </div>
                <div class="tab-pane fade" id="tab-news" role="tabpanel" aria-labelledby="news-tab">
                    <div class="main-card mb-3 card">
                        <div class="card-header d-flex">
                            <div>Last articles:</div>
                            <div class="ms-4">
                                <input checked type="radio" class="btn-check" name="options" id="option1" autocomplete="off">
                                <label class="btn btn-primary btn-sm news-btn" for="option1" data-limit="10">10</label>

                                <input type="radio" class="btn-check" name="options" id="option2" autocomplete="off">
                                <label class="btn btn-primary btn-sm news-btn" for="option2" data-limit="20">20</label>

                                <input type="radio" class="btn-check" name="options" id="option3" autocomplete="off">
                                <label class="btn btn-primary btn-sm news-btn" for="option3" data-limit="30">30</label>

                                <input type="radio" class="btn-check" name="options" id="option4" autocomplete="off">
                                <label class="btn btn-primary btn-sm news-btn" for="option4" data-limit="40">40</label>

                                <input type="radio" class="btn-check" name="options" id="option5" autocomplete="off">
                                <label class="btn btn-primary btn-sm news-btn" for="option5" data-limit="100">100</label>
                            </div>
                        </div>
                        <div class="card-body tab-news-card">
                            <div class="div-content" ></div>
                        </div>
                    </div>`
                </div>
                <div class="tab-pane fade" id="tab-insiders" role="tabpanel" aria-labelledby="insiders-tab">
                    <div class="main-card mb-3 card">
                        <div class="card-body tab-insiders-card">
                            <div class="div-content" ></div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab-press-relises" role="tabpanel" aria-labelledby="press-relises-tab">
                    <div class="main-card mb-3 card">
                        <div class="card-body tab-press-relises-card" style="position: relative;">
                            <div class="div-content" ></div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab-technicals" role="tabpanel" aria-labelledby="technicals-tab">
                    <div class="main-card mb-3 card">
                        <div class="card-body tab-technicals-card" style="position: relative;">
                            <div class="div-content" >
                                coming soon
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row d-none">
    <div class="col">
        <div class="card mb-1">
            Company info
        </div>
    </div>
</div>

{% endblock %}
{% block scripting %}
<script>
var ticker = '{{ candidate.ticker }}';
var TOOLTIPS = {{ tooltips|tojson }};
var company_name = '{{ candidate.company_name }}';
var user_email = '{{ current_user.email }}';
var hist_data = '{{ hist_data|tojson }}';
</script>
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/data.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.2.0/chart.min.js"
        integrity="sha512-VMsZqo0ar06BMtg0tPsdgRADvl0kDHpTbugCBBrL55KmucH6hP9zWdLIWY//OTfMnzz6xWQRxQqsUFefwHuHyg=="
        crossorigin="anonymous"></script>
<script type="text/javascript" src="{{ url_for('static', filename='scripts/pages/snp_graph.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='scripts/pages/spyder_project.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='scripts/pages/ticker_info_new.js') }}"></script>

<script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='scripts/pages/echarts-example-cola.js') }}"></script>

{% endblock %}
echarts-example-tickerinfo.js
{% block modal %}
<div style="display: none" id="ticker-info-modal"></div>
{% endblock %}